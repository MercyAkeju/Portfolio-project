
SELECT * FROM COUNTRY;

SELECT * FROM ACTOR;

SELECT FIRST_NAME, LAST_NAME FROM ACTOR;
SELECT FIRST_NAME FROM ACTOR;

SELECT DISTINCT RENTAL_DURATION FROM FILM;

SELECT FIRST_NAME, LAST_NAME FROM ACTOR
ORDER BY LAST_NAME ASC;

SELECT * FROM PAYMENT
ORDER BY AMOUNT DESC;

SELECT * FROM PAYMENT 
ORDER BY AMOUNT DESC
LIMIT 5

SELECT FIRST_NAME, LAST_NAME FROM CUSTOMER 
WHERE FIRST_NAME = 'Jamie';

-- FETCH THE FULL NAME OF THE CUSTOMER(S) WHOSE FIRSTNAME IS 'JAMIE' and lastname is "rice"
SELECT FIRST_NAME, LAST_NAME FROM CUSTOMER 
WHERE FIRST_NAME = 'Jamie' AND LAST_NAME = 'Rice';

-- those who paid rental rate amount greater than 10
select * from payment;

select customer_id, amount from payment
where amount > 10;
	 
-- WE WANT TO KNOW THE CUSTOMERS WHO HAVE PAID AN AMOUNT BETWEEN 8 AND 10 USD 

SELECT CUSTOMER_ID, AMOUNT FROM PAYMENT 
WHERE AMOUNT BETWEEN 8 AND 10;

-- GET ALL INFO OF CUSTOMER 361, 362 AND 363
SELECT * FROM CUSTOMER
WHERE CUSTOMER_ID IN (361,362, 363);


-- GET THE INFO OF CUSTOMERS WHOSE FIRSTNAME START WITH "Jen"
SELECT * FROM CUSTOMER 
WHERE FIRST_NAME LIKE 'Jen%';

-- GET THE INFO OF CUSTOMERS WHOSE FIRSTNAME START WITH "Jen" and have two letter afterwards
SELECT * FROM CUSTOMER 
WHERE FIRST_NAME LIKE 'Jen__';

-- get the info of customers whose lastname ENDS with 'is'
SELECT * FROM CUSTOMER 
WHERE last_NAME LIKE '%is';

-- GET THE INFO OF CUSTOMERS WHOSE FIRSTNAME START WITH "Jen" and lastnme end with "is"
select * from customer
where first_name like 'Jen%' and last_name like '%is';


SELECT * FROM PAYMENT;

-- TOTAL AMOUNT MADE FROM SALES 
SELECT SUM(AMOUNT) FROM PAYMENT;

-- HOW MANY TRANSACTIONS WERE PROCESSED 
SELECT COUNT(AMOUNT) FROM PAYMENT;

-- WHAT IS THE MINIMUM AMOUNT PAAID 
SELECT MIN(AMOUNT) FROM PAYMENT;

SELECT SUM(AMOUNT), COUNT(AMOUNT), MIN(AMOUNT), AVG(AMOUNT) FROM PAYMENT;

-- Renaming Columns
SELECT SUM(AMOUNT) AS TOTAL_AMOUNT, 
COUNT(AMOUNT) AS NO_OF_TRANSACTIONS, 
MIN(AMOUNT) AS _MIN_AMOUNT, 
AVG(AMOUNT) AS AVG_AMOUNT 
FROM PAYMENT;

-- GROUPING RECORDS 
SELECT * FROM PAYMENT;

SELECT CUSTOMER_ID, AMOUNT FROM PAYMENT;

-- HOW MUCH HAS EACH CUSTOMERS SPENT 
SELECT CUSTOMER_ID, SUM(AMOUNT) FROM PAYMENT
GROUP BY CUSTOMER_ID;

SELECT CUSTOMER_ID, SUM(AMOUNT) AS TOTAL_AMOUNT FROM PAYMENT
GROUP BY CUSTOMER_ID;

SELECT CUSTOMER_ID, SUM(AMOUNT) AS TOTAL_AMOUNT FROM PAYMENT
GROUP BY CUSTOMER_ID
ORDER BY TOTAL_AMOUNT DESC;

SELECT CUSTOMER_ID, SUM(AMOUNT) AS TOTAL_AMOUNT FROM PAYMENT
GROUP BY CUSTOMER_ID
ORDER BY TOTAL_AMOUNT DESC
LIMIT 10;

-- WE WANT TO KNOW THE CUSTOMERS WHO HAVE SPENT BETWEEN USD100 AND USD150

SELECT CUSTOMER_ID, SUM(AMOUNT) AS TOTAL_AMOUNT FROM PAYMENT
GROUP BY CUSTOMER_ID
HAVING SUM(AMOUNT) BETWEEN 100 AND 150
ORDER BY TOTAL_AMOUNT ASC;


-- LETS GET THE NAMES OF OUR PAYING CUSTOMERS 
SELECT * FROM CUSTOMER;
-- CUSTOMER_ID, FIRST_NAME, LAST_NAME 

SELECT * FROM PAYMENT;
-- CUSTOMER_ID, AMOUNT 

-- RELATIONSHIP:  CUSTOMER_ID

-- ORIGINAL JOIN CODE

SELECT CUSTOMER.CUSTOMER_ID, FIRST_NAME, LAST_NAME, PAYMENT.CUSTOMER_ID, AMOUNT
FROM CUSTOMER 
INNER JOIN PAYMENT
ON CUSTOMER.CUSTOMER_ID = PAYMENT.CUSTOMER_ID;

SELECT CUSTOMER.CUSTOMER_ID, FIRST_NAME, LAST_NAME, AMOUNT
FROM CUSTOMER 
INNER JOIN PAYMENT
ON CUSTOMER.CUSTOMER_ID = PAYMENT.CUSTOMER_ID;

-- LETS CONFIRM IF ALL OUR FILMS ARE IN THE INVENTORY

SELECT * FROM film;
-- FILM_ID, TITLE
SELECT * FROM INVENTORY;
-- INVOETORY_ID, FILM_ID

-- RELATIONSHIP: FILM_ID

SELECT FILM.FILM_ID, TITLE, INVENTORY_ID, INVENTORY.FILM_ID
FROM FILM 
LEFT JOIN INVENTORY
ON FILM.FILM_ID = INVENTORY.FILM_ID;

--Creating a table called IDAN 
CREATE TABLE IDAN(
	STUDENT_ID INT PRIMARY KEY,
	NAME VARCHAR(20) NOT NULL,
	GENDER CHAR(1),
	LOCATION VARCHAR(20) NOT NUL
);

SELECT * FROM IDAN;

INSERT INTO IDAN
	(STUDENT_ID, NAME, GENDER, LOCATION)
VALUES
	(001, 'MUHAMMAD JAMIL', 'M', 'KANO'), 
	(002, 'ABIODUN OGUNNIYI', 'M', 'LAGOS'),
	(003, 'AHMED OLUSANYA', 'M', 'OGUN'),
	(004, 'OYEWOLE OLUWOLE', 'F', 'ABUJA'),
	(005, 'MOROMOKE OLALEYE', 'F', 'ABUJA'),
	(006, 'NGOZI', 'F', 'ANAMBRA'),
	(007, 'OLUWAKOYA EMIOLA', 'M', 'LAGOS'),
	(008, 'QUEEN ITUA', 'F', 'OGUN');

SELECT * FROM IDAN
ORDER BY NAME ASC ;

--Finding number of payment transacion greater than $5
SELECT COUNT(PAYMENT_ID) FROM PAYMENT WHERE AMOUNT > 5;

--Finding number of actors with first name starting with the letter P
SELECT COUNT(FIRST_NAME) FROM ACTOR WHERE FIRST_NAME LIKE 'P%';

--Number of unique districts of customers
SELECT * FROM ADDRESS;
SELECT COUNT(DISTINCT DISTRICT) FROM ADDRESS;

--list of names for those distinct districts
SELECT DISTINCT DISTRICT FROM ADDRESS;

--Films wih the word Truman somewhere in the title? 
SELECT * FROM FILM;
SELECT COUNT(TITLE) FROM FILM WHERE TITLE LIKE '%Truman%';

-- Creaing Table leads
CREATE TABLE LEADS (ID_TRACKER INT PRIMARY KEY,
							 FIRST_NAME VARCHAR(15) NOT NULL,
							 LAST_NAME VARCHAR(15) NOT NULL,
							 EMAIL VARCHAR(25) NOT NULL,
							 SIGN_UP_DATE DATE NOT NULL,
							 TIME_SPENT TIME(6) NOT NULL);
SELECT * FROM LEADS;
INSERT INTO LEADS (ID_TRACKER, FIRST_NAME, LAST_NAME, EMAIL, SIGN_UP_DATE, TIME_SPENT)
VALUES (01, 'MERCY', 'AKEJU', 'mercyakeju001@gmail.com', '2023-10-28', '5:30:20');
							

--Returning the customer IDs of customers who have spent at least $110 with the staff member
--who has an ID of 2.
SELECT * FROM PAYMENT;
SELECT CUSTOMER_ID, SUM(AMOUNT) AS TOTAL_AMOUNT
FROM PAYMENT
WHERE STAFF_ID = 2
GROUP BY CUSTOMER_ID
HAVING SUM(AMOUNT) >= 110;

--Number of films with a rating of R and a replacement cost between $5 and $15
SELECT * FROM FILM;
SELECT COUNT(FILM_ID) FROM FILM
WHERE RATING = 'R' AND REPLACEMENT_COST BETWEEN 5 AND 15;
